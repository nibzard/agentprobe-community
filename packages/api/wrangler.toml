name = "agentprobe-community"
main = "src/index.ts"
compatibility_date = "2024-10-01"
compatibility_flags = ["nodejs_compat"]

# Worker configuration will use TypeScript directly

# Environment variables for development
[vars]
ENVIRONMENT = "development"
LOG_LEVEL = "debug"
CORS_ORIGINS = "http://localhost:3000,https://agentprobe.dev"

# D1 Database binding for development
[[d1_databases]]
binding = "DB"
database_name = "agentprobe-community-dev"
database_id = "25f7c244-7c51-49e4-8ba6-b7d4fdd66a7c"
migrations_dir = "./migrations"

# Analytics Engine for metrics
[[analytics_engine_datasets]]
binding = "ANALYTICS"
dataset = "agentprobe_metrics"

# Production environment configuration
[env.production]
vars = { ENVIRONMENT = "production", LOG_LEVEL = "info", CORS_ORIGINS = "https://agentprobe.dev,https://www.agentprobe.dev" }

[[env.production.d1_databases]]
binding = "DB"
database_name = "agentprobe-community-prod"
database_id = "2e6925cb-2738-452a-a12e-0def0fb6a969"
migrations_dir = "./migrations"

[[env.production.analytics_engine_datasets]]
binding = "ANALYTICS"
dataset = "agentprobe_metrics_prod"

# Staging environment configuration
[env.staging]
vars = { ENVIRONMENT = "staging", LOG_LEVEL = "info", CORS_ORIGINS = "https://staging.agentprobe.dev" }

[[env.staging.d1_databases]]
binding = "DB"
database_name = "agentprobe-community-staging"
database_id = "1feed6aa-0e8b-4dec-9906-626e57f87d6b"
migrations_dir = "./migrations"

[[env.staging.analytics_engine_datasets]]
binding = "ANALYTICS"
dataset = "agentprobe_metrics_staging"